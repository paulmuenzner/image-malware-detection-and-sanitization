import os
import os.path
import sys

import pytest

sys.path.append(
    os.path.abspath(
        os.path.join(
            os.path.dirname(__file__), os.path.pardir, os.path.pardir, os.path.pardir
        )
    )
)

from utils.chunk_occurrence import validate_count


@pytest.mark.parametrize(
    "count, allowed_number, criteria, chunk_name, expected_result",
    [
        (
            5,
            10,
            "maximum",
            "chunks",
            {
                "error": False,
                "message": "Permitted number of chunk chunks in image. Permitted: maximum 10. Count: 5",
            },
        ),
        (
            15,
            10,
            "maximum",
            "chunks",
            {
                "error": True,
                "message": "More chunks chunks than permitted. Permitted: maximum 10. Count: 15",
            },
        ),
        (
            5,
            10,
            "minimum",
            "chunks",
            {
                "error": True,
                "message": "Less chunks chunks than permitted. Permitted: minimum 10. Count: 5",
            },
        ),
        (
            10,
            10,
            "minimum",
            "chunks",
            {
                "error": False,
                "message": "Permitted number of chunk chunks in image. Permitted: minimum 10. Count: 10",
            },
        ),
        (
            10,
            10,
            "exact",
            "chunks",
            {
                "error": False,
                "message": "Permitted number of chunk chunks in image. Permitted: exact 10. Count: 10",
            },
        ),
        (
            8,
            10,
            "exact",
            "chunks",
            {
                "error": True,
                "message": "Not exact number of permitted chunk chunks. Permitted: exact 10. Count: 8",
            },
        ),
    ],
)
def test_validate_count(count, allowed_number, criteria, chunk_name, expected_result):
    result = validate_count(count, allowed_number, criteria, chunk_name)
    assert result == expected_result
