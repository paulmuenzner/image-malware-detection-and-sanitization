import os
import os.path
import sys

import pytest

sys.path.append(
    os.path.abspath(
        os.path.join(
            os.path.dirname(__file__), os.path.pardir, os.path.pardir, os.path.pardir
        )
    )
)


from utils.chunk_occurrence import validate_occurrence


@pytest.mark.parametrize(
    "file_string, chunk_name, value, expected_result",
    [
        # Other test cases...
        (
            "hello",
            "invalid",
            {"signature": "invalid", "occurrence": {"number": 1, "criteria": "exact"}},
            {
                "index_positions": [],
                "chunk_name": "invalid",
                "validation_count": {
                    "error": True,
                    "message": "Not exact number of permitted chunk invalid. Permitted: exact 1. Count: 0",
                },
            },
        ),
    ],
)
def test_validate_occurrence(file_string, chunk_name, value, expected_result):
    result = validate_occurrence(file_string, chunk_name, value)
    assert result == expected_result
