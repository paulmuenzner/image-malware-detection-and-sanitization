import os
import os.path
import sys

import pytest

from data.signature_list_png import PNG_SIGNATURES

sys.path.append(
    os.path.abspath(
        os.path.join(
            os.path.dirname(__file__), os.path.pardir, os.path.pardir, os.path.pardir
        )
    )
)


from utils.select_signature_lib import select_signature_lib


def test_select_signature_lib():
    # Test valid extension
    result = select_signature_lib("png")
    assert result == PNG_SIGNATURES

    # Test invalid extension
    with pytest.raises(
        ValueError, match="No signature library available for your extension: invalid"
    ):
        select_signature_lib("invalid")

    # Test case-insensitive extension
    with pytest.raises(
        ValueError, match="No signature library available for your extension: JPG"
    ):
        select_signature_lib("JPG")

    # Test empty extension
    with pytest.raises(
        ValueError, match="No signature library available for your extension: "
    ):
        select_signature_lib("")

    # Test None as extension
    with pytest.raises(ValueError, match="Extension cannot be None."):
        select_signature_lib(None)
